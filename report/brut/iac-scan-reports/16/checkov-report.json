{"check_type": "terraform", "results": {"passed_checks": [{"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "PASSED", "evaluated_keys": ["network_interfaces/[0]/associate_public_ip_address"]}, "code_block": [[18, "resource \"aws_launch_template\" \"ecs_staging\" {\n"], [19, "  name_prefix   = \"${var.project_name}-staging-\"\n"], [20, "  image_id      = data.aws_ami.ecs_optimized.id\n"], [21, "  instance_type = \"t2.micro\"  # FREE TIER!\n"], [22, "\n"], [23, "  iam_instance_profile {\n"], [24, "    name = aws_iam_instance_profile.ecs.name\n"], [25, "  }\n"], [26, "\n"], [27, "  vpc_security_group_ids = [aws_security_group.ecs.id]\n"], [28, "\n"], [29, "  user_data = base64encode(<<-EOF\n"], [30, "              #!/bin/bash\n"], [31, "              echo ECS_CLUSTER=${aws_ecs_cluster.staging.name} >> /etc/ecs/ecs.config\n"], [32, "              EOF\n"], [33, "  )\n"], [34, "\n"], [35, "  monitoring {\n"], [36, "    enabled = false  # Detailed monitoring costs extra\n"], [37, "  }\n"], [38, "\n"], [39, "  tag_specifications {\n"], [40, "    resource_type = \"instance\"\n"], [41, "    tags = {\n"], [42, "      Name = \"${var.project_name}-staging-ecs-instance\"\n"], [43, "    }\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [18, 45], "resource": "aws_launch_template.ecs_staging", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "breadcrumbs": {"name_prefix": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "user_data": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecs_cluster.staging", "path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "module_connection": false}], "iam_instance_profile.name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ecs", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "PASSED", "evaluated_keys": ["user_data"]}, "code_block": [[18, "resource \"aws_launch_template\" \"ecs_staging\" {\n"], [19, "  name_prefix   = \"${var.project_name}-staging-\"\n"], [20, "  image_id      = data.aws_ami.ecs_optimized.id\n"], [21, "  instance_type = \"t2.micro\"  # FREE TIER!\n"], [22, "\n"], [23, "  iam_instance_profile {\n"], [24, "    name = aws_iam_instance_profile.ecs.name\n"], [25, "  }\n"], [26, "\n"], [27, "  vpc_security_group_ids = [aws_security_group.ecs.id]\n"], [28, "\n"], [29, "  user_data = base64encode(<<-EOF\n"], [30, "              #!/bin/bash\n"], [31, "              echo ECS_CLUSTER=${aws_ecs_cluster.staging.name} >> /etc/ecs/ecs.config\n"], [32, "              EOF\n"], [33, "  )\n"], [34, "\n"], [35, "  monitoring {\n"], [36, "    enabled = false  # Detailed monitoring costs extra\n"], [37, "  }\n"], [38, "\n"], [39, "  tag_specifications {\n"], [40, "    resource_type = \"instance\"\n"], [41, "    tags = {\n"], [42, "      Name = \"${var.project_name}-staging-ecs-instance\"\n"], [43, "    }\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [18, 45], "resource": "aws_launch_template.ecs_staging", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "breadcrumbs": {"name_prefix": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "user_data": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecs_cluster.staging", "path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "module_connection": false}], "iam_instance_profile.name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ecs", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_341", "bc_check_id": "BC_AWS_GENERAL_244", "check_name": "Ensure Launch template should not have a metadata response hop limit greater than 1", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata_options/[0]/http_put_response_hop_limit"]}, "code_block": [[18, "resource \"aws_launch_template\" \"ecs_staging\" {\n"], [19, "  name_prefix   = \"${var.project_name}-staging-\"\n"], [20, "  image_id      = data.aws_ami.ecs_optimized.id\n"], [21, "  instance_type = \"t2.micro\"  # FREE TIER!\n"], [22, "\n"], [23, "  iam_instance_profile {\n"], [24, "    name = aws_iam_instance_profile.ecs.name\n"], [25, "  }\n"], [26, "\n"], [27, "  vpc_security_group_ids = [aws_security_group.ecs.id]\n"], [28, "\n"], [29, "  user_data = base64encode(<<-EOF\n"], [30, "              #!/bin/bash\n"], [31, "              echo ECS_CLUSTER=${aws_ecs_cluster.staging.name} >> /etc/ecs/ecs.config\n"], [32, "              EOF\n"], [33, "  )\n"], [34, "\n"], [35, "  monitoring {\n"], [36, "    enabled = false  # Detailed monitoring costs extra\n"], [37, "  }\n"], [38, "\n"], [39, "  tag_specifications {\n"], [40, "    resource_type = \"instance\"\n"], [41, "    tags = {\n"], [42, "      Name = \"${var.project_name}-staging-ecs-instance\"\n"], [43, "    }\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [18, 45], "resource": "aws_launch_template.ecs_staging", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchTemplateMetadataHop", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-341", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "breadcrumbs": {"name_prefix": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "user_data": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecs_cluster.staging", "path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "module_connection": false}], "iam_instance_profile.name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ecs", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_315", "bc_check_id": "BC_AWS_GENERAL_226", "check_name": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[48, "resource \"aws_autoscaling_group\" \"ecs_staging\" {\n"], [49, "  name                = \"${var.project_name}-staging-asg\"\n"], [50, "  vpc_zone_identifier = aws_subnet.public[*].id\n"], [51, "  min_size            = 1\n"], [52, "  max_size            = 1  # Keep at 1 for free tier\n"], [53, "  desired_capacity    = 1\n"], [54, "\n"], [55, "  launch_template {\n"], [56, "    id      = aws_launch_template.ecs_staging.id\n"], [57, "    version = \"$Latest\"\n"], [58, "  }\n"], [59, "\n"], [60, "  tag {\n"], [61, "    key                 = \"Name\"\n"], [62, "    value               = \"${var.project_name}-staging-ecs\"\n"], [63, "    propagate_at_launch = true\n"], [64, "  }\n"], [65, "\n"], [66, "  tag {\n"], [67, "    key                 = \"AmazonECSManaged\"\n"], [68, "    value               = true\n"], [69, "    propagate_at_launch = true\n"], [70, "  }\n"], [71, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [48, 71], "resource": "aws_autoscaling_group.ecs_staging", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AutoScalingLaunchTemplate", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-315", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag.0.value": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag.0": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_153", "bc_check_id": "BC_AWS_GENERAL_82", "check_name": "Autoscaling groups should supply tags to launch configurations", "check_result": {"result": "PASSED", "evaluated_keys": ["tag", "tags"]}, "code_block": [[48, "resource \"aws_autoscaling_group\" \"ecs_staging\" {\n"], [49, "  name                = \"${var.project_name}-staging-asg\"\n"], [50, "  vpc_zone_identifier = aws_subnet.public[*].id\n"], [51, "  min_size            = 1\n"], [52, "  max_size            = 1  # Keep at 1 for free tier\n"], [53, "  desired_capacity    = 1\n"], [54, "\n"], [55, "  launch_template {\n"], [56, "    id      = aws_launch_template.ecs_staging.id\n"], [57, "    version = \"$Latest\"\n"], [58, "  }\n"], [59, "\n"], [60, "  tag {\n"], [61, "    key                 = \"Name\"\n"], [62, "    value               = \"${var.project_name}-staging-ecs\"\n"], [63, "    propagate_at_launch = true\n"], [64, "  }\n"], [65, "\n"], [66, "  tag {\n"], [67, "    key                 = \"AmazonECSManaged\"\n"], [68, "    value               = true\n"], [69, "    propagate_at_launch = true\n"], [70, "  }\n"], [71, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [48, 71], "resource": "aws_autoscaling_group.ecs_staging", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AutoScalingTagging", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/autoscaling-groups-should-supply-tags-to-launch-configurations", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag.0.value": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag.0": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "PASSED", "evaluated_keys": ["network_interfaces/[0]/associate_public_ip_address"]}, "code_block": [[74, "resource \"aws_launch_template\" \"ecs_production\" {\n"], [75, "  name_prefix   = \"${var.project_name}-prod-\"\n"], [76, "  image_id      = data.aws_ami.ecs_optimized.id\n"], [77, "  instance_type = \"t2.micro\"  # FREE TIER!\n"], [78, "\n"], [79, "  iam_instance_profile {\n"], [80, "    name = aws_iam_instance_profile.ecs.name\n"], [81, "  }\n"], [82, "\n"], [83, "  vpc_security_group_ids = [aws_security_group.ecs.id]\n"], [84, "\n"], [85, "  user_data = base64encode(<<-EOF\n"], [86, "              #!/bin/bash\n"], [87, "              echo ECS_CLUSTER=${aws_ecs_cluster.production.name} >> /etc/ecs/ecs.config\n"], [88, "              EOF\n"], [89, "  )\n"], [90, "\n"], [91, "  monitoring {\n"], [92, "    enabled = false  # Detailed monitoring costs extra\n"], [93, "  }\n"], [94, "\n"], [95, "  tag_specifications {\n"], [96, "    resource_type = \"instance\"\n"], [97, "    tags = {\n"], [98, "      Name = \"${var.project_name}-production-ecs-instance\"\n"], [99, "    }\n"], [100, "  }\n"], [101, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [74, 101], "resource": "aws_launch_template.ecs_production", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "breadcrumbs": {"name_prefix": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "user_data": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecs_cluster.production", "path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "module_connection": false}], "iam_instance_profile.name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ecs", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "PASSED", "evaluated_keys": ["user_data"]}, "code_block": [[74, "resource \"aws_launch_template\" \"ecs_production\" {\n"], [75, "  name_prefix   = \"${var.project_name}-prod-\"\n"], [76, "  image_id      = data.aws_ami.ecs_optimized.id\n"], [77, "  instance_type = \"t2.micro\"  # FREE TIER!\n"], [78, "\n"], [79, "  iam_instance_profile {\n"], [80, "    name = aws_iam_instance_profile.ecs.name\n"], [81, "  }\n"], [82, "\n"], [83, "  vpc_security_group_ids = [aws_security_group.ecs.id]\n"], [84, "\n"], [85, "  user_data = base64encode(<<-EOF\n"], [86, "              #!/bin/bash\n"], [87, "              echo ECS_CLUSTER=${aws_ecs_cluster.production.name} >> /etc/ecs/ecs.config\n"], [88, "              EOF\n"], [89, "  )\n"], [90, "\n"], [91, "  monitoring {\n"], [92, "    enabled = false  # Detailed monitoring costs extra\n"], [93, "  }\n"], [94, "\n"], [95, "  tag_specifications {\n"], [96, "    resource_type = \"instance\"\n"], [97, "    tags = {\n"], [98, "      Name = \"${var.project_name}-production-ecs-instance\"\n"], [99, "    }\n"], [100, "  }\n"], [101, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [74, 101], "resource": "aws_launch_template.ecs_production", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "breadcrumbs": {"name_prefix": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "user_data": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecs_cluster.production", "path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "module_connection": false}], "iam_instance_profile.name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ecs", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_341", "bc_check_id": "BC_AWS_GENERAL_244", "check_name": "Ensure Launch template should not have a metadata response hop limit greater than 1", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata_options/[0]/http_put_response_hop_limit"]}, "code_block": [[74, "resource \"aws_launch_template\" \"ecs_production\" {\n"], [75, "  name_prefix   = \"${var.project_name}-prod-\"\n"], [76, "  image_id      = data.aws_ami.ecs_optimized.id\n"], [77, "  instance_type = \"t2.micro\"  # FREE TIER!\n"], [78, "\n"], [79, "  iam_instance_profile {\n"], [80, "    name = aws_iam_instance_profile.ecs.name\n"], [81, "  }\n"], [82, "\n"], [83, "  vpc_security_group_ids = [aws_security_group.ecs.id]\n"], [84, "\n"], [85, "  user_data = base64encode(<<-EOF\n"], [86, "              #!/bin/bash\n"], [87, "              echo ECS_CLUSTER=${aws_ecs_cluster.production.name} >> /etc/ecs/ecs.config\n"], [88, "              EOF\n"], [89, "  )\n"], [90, "\n"], [91, "  monitoring {\n"], [92, "    enabled = false  # Detailed monitoring costs extra\n"], [93, "  }\n"], [94, "\n"], [95, "  tag_specifications {\n"], [96, "    resource_type = \"instance\"\n"], [97, "    tags = {\n"], [98, "      Name = \"${var.project_name}-production-ecs-instance\"\n"], [99, "    }\n"], [100, "  }\n"], [101, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [74, 101], "resource": "aws_launch_template.ecs_production", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchTemplateMetadataHop", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-341", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "breadcrumbs": {"name_prefix": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "user_data": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecs_cluster.production", "path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "module_connection": false}], "iam_instance_profile.name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ecs", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_315", "bc_check_id": "BC_AWS_GENERAL_226", "check_name": "Ensure EC2 Auto Scaling groups use EC2 launch templates", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[104, "resource \"aws_autoscaling_group\" \"ecs_production\" {\n"], [105, "  name                = \"${var.project_name}-prod-asg\"\n"], [106, "  vpc_zone_identifier = aws_subnet.public[*].id\n"], [107, "  min_size            = 1\n"], [108, "  max_size            = 1  # Keep at 1 for free tier\n"], [109, "  desired_capacity    = 1\n"], [110, "\n"], [111, "  launch_template {\n"], [112, "    id      = aws_launch_template.ecs_production.id\n"], [113, "    version = \"$Latest\"\n"], [114, "  }\n"], [115, "\n"], [116, "  tag {\n"], [117, "    key                 = \"Name\"\n"], [118, "    value               = \"${var.project_name}-production-ecs\"\n"], [119, "    propagate_at_launch = true\n"], [120, "  }\n"], [121, "\n"], [122, "  tag {\n"], [123, "    key                 = \"AmazonECSManaged\"\n"], [124, "    value               = true\n"], [125, "    propagate_at_launch = true\n"], [126, "  }\n"], [127, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [104, 127], "resource": "aws_autoscaling_group.ecs_production", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AutoScalingLaunchTemplate", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-315", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag.0.value": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag.0": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_153", "bc_check_id": "BC_AWS_GENERAL_82", "check_name": "Autoscaling groups should supply tags to launch configurations", "check_result": {"result": "PASSED", "evaluated_keys": ["tag", "tags"]}, "code_block": [[104, "resource \"aws_autoscaling_group\" \"ecs_production\" {\n"], [105, "  name                = \"${var.project_name}-prod-asg\"\n"], [106, "  vpc_zone_identifier = aws_subnet.public[*].id\n"], [107, "  min_size            = 1\n"], [108, "  max_size            = 1  # Keep at 1 for free tier\n"], [109, "  desired_capacity    = 1\n"], [110, "\n"], [111, "  launch_template {\n"], [112, "    id      = aws_launch_template.ecs_production.id\n"], [113, "    version = \"$Latest\"\n"], [114, "  }\n"], [115, "\n"], [116, "  tag {\n"], [117, "    key                 = \"Name\"\n"], [118, "    value               = \"${var.project_name}-production-ecs\"\n"], [119, "    propagate_at_launch = true\n"], [120, "  }\n"], [121, "\n"], [122, "  tag {\n"], [123, "    key                 = \"AmazonECSManaged\"\n"], [124, "    value               = true\n"], [125, "    propagate_at_launch = true\n"], [126, "  }\n"], [127, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [104, 127], "resource": "aws_autoscaling_group.ecs_production", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AutoScalingTagging", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/autoscaling-groups-should-supply-tags-to-launch-configurations", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag.0.value": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag.0": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_386", "bc_check_id": "BC_AWS_GENERAL_271", "check_name": "Reduce potential for WhoAMI cloud image name confusion attack", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "data \"aws_ami\" \"ecs_optimized\" {\n"], [3, "  most_recent = true\n"], [4, "  owners      = [\"amazon\"]\n"], [5, "\n"], [6, "  filter {\n"], [7, "    name   = \"name\"\n"], [8, "    values = [\"amzn2-ami-ecs-hvm-*-x86_64-ebs\"]\n"], [9, "  }\n"], [10, "\n"], [11, "  filter {\n"], [12, "    name   = \"virtualization-type\"\n"], [13, "    values = [\"hvm\"]\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [2, 15], "resource": "aws_ami.ecs_optimized", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.WhoAMI", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-supply-chain-policies/bc-aws-386", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf"}, {"check_id": "CKV_AWS_163", "bc_check_id": "BC_AWS_GENERAL_8", "check_name": "Ensure ECR image scanning on push is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["image_scanning_configuration/[0]/scan_on_push"]}, "code_block": [[2, "resource \"aws_ecr_repository\" \"app\" {\n"], [3, "  name                 = var.project_name\n"], [4, "  image_tag_mutability = \"MUTABLE\"\n"], [5, "\n"], [6, "  image_scanning_configuration {\n"], [7, "    scan_on_push = true\n"], [8, "  }\n"], [9, "\n"], [10, "  tags = {\n"], [11, "    Name        = var.project_name\n"], [12, "    Environment = var.environment\n"], [13, "  }\n"], [14, "}\n"]], "file_path": "/ecr.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecr.tf", "repo_file_path": "/terraform/ecr.tf", "file_line_range": [2, 14], "resource": "aws_ecr_repository.app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECRImageScanning", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-8", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecr.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecr_repository.app", "path": "/home/runner/work/Sample/Sample/terraform/ecr.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[52, "resource \"aws_security_group\" \"ecs\" {\n"], [53, "  name        = \"${var.project_name}-ecs-sg\"\n"], [54, "  vpc_id      = aws_vpc.main.id\n"], [55, "  description = \"Security group for ECS EC2 instances\"\n"], [56, "\n"], [57, "  # Allow direct access to application port\n"], [58, "  ingress {\n"], [59, "    from_port   = 8080\n"], [60, "    to_port     = 8080\n"], [61, "    protocol    = \"tcp\"\n"], [62, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [63, "    description = \"Allow HTTP traffic to application\"\n"], [64, "  }\n"], [65, "\n"], [66, "  # Allow SSH for troubleshooting (restrict in production)\n"], [67, "  ingress {\n"], [68, "    from_port   = 22\n"], [69, "    to_port     = 22\n"], [70, "    protocol    = \"tcp\"\n"], [71, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [72, "    description = \"Allow SSH access\"\n"], [73, "  }\n"], [74, "\n"], [75, "  egress {\n"], [76, "    from_port   = 0\n"], [77, "    to_port     = 0\n"], [78, "    protocol    = \"-1\"\n"], [79, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name = \"${var.project_name}-ecs-sg\"\n"], [84, "  }\n"], [85, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [52, 85], "resource": "aws_security_group.ecs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-ecs-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[52, "resource \"aws_security_group\" \"ecs\" {\n"], [53, "  name        = \"${var.project_name}-ecs-sg\"\n"], [54, "  vpc_id      = aws_vpc.main.id\n"], [55, "  description = \"Security group for ECS EC2 instances\"\n"], [56, "\n"], [57, "  # Allow direct access to application port\n"], [58, "  ingress {\n"], [59, "    from_port   = 8080\n"], [60, "    to_port     = 8080\n"], [61, "    protocol    = \"tcp\"\n"], [62, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [63, "    description = \"Allow HTTP traffic to application\"\n"], [64, "  }\n"], [65, "\n"], [66, "  # Allow SSH for troubleshooting (restrict in production)\n"], [67, "  ingress {\n"], [68, "    from_port   = 22\n"], [69, "    to_port     = 22\n"], [70, "    protocol    = \"tcp\"\n"], [71, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [72, "    description = \"Allow SSH access\"\n"], [73, "  }\n"], [74, "\n"], [75, "  egress {\n"], [76, "    from_port   = 0\n"], [77, "    to_port     = 0\n"], [78, "    protocol    = \"-1\"\n"], [79, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name = \"${var.project_name}-ecs-sg\"\n"], [84, "  }\n"], [85, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [52, 85], "resource": "aws_security_group.ecs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-ecs-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[52, "resource \"aws_security_group\" \"ecs\" {\n"], [53, "  name        = \"${var.project_name}-ecs-sg\"\n"], [54, "  vpc_id      = aws_vpc.main.id\n"], [55, "  description = \"Security group for ECS EC2 instances\"\n"], [56, "\n"], [57, "  # Allow direct access to application port\n"], [58, "  ingress {\n"], [59, "    from_port   = 8080\n"], [60, "    to_port     = 8080\n"], [61, "    protocol    = \"tcp\"\n"], [62, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [63, "    description = \"Allow HTTP traffic to application\"\n"], [64, "  }\n"], [65, "\n"], [66, "  # Allow SSH for troubleshooting (restrict in production)\n"], [67, "  ingress {\n"], [68, "    from_port   = 22\n"], [69, "    to_port     = 22\n"], [70, "    protocol    = \"tcp\"\n"], [71, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [72, "    description = \"Allow SSH access\"\n"], [73, "  }\n"], [74, "\n"], [75, "  egress {\n"], [76, "    from_port   = 0\n"], [77, "    to_port     = 0\n"], [78, "    protocol    = \"-1\"\n"], [79, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name = \"${var.project_name}-ecs-sg\"\n"], [84, "  }\n"], [85, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [52, 85], "resource": "aws_security_group.ecs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-ecs-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_223", "bc_check_id": "BC_AWS_GENERAL_171", "check_name": "Ensure ECS Cluster enables logging of ECS Exec", "check_result": {"result": "PASSED", "evaluated_keys": ["configuration/[0]/execute_command_configuration/[0]/logging"]}, "code_block": [[88, "resource \"aws_ecs_cluster\" \"staging\" {\n"], [89, "  name = \"${var.project_name}-staging\"\n"], [90, "\n"], [91, "  setting {\n"], [92, "    name  = \"containerInsights\"\n"], [93, "    value = \"disabled\"  # Disabled to save costs\n"], [94, "  }\n"], [95, "\n"], [96, "  tags = {\n"], [97, "    Name        = \"${var.project_name}-staging\"\n"], [98, "    Environment = \"staging\"\n"], [99, "  }\n"], [100, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [88, 100], "resource": "aws_ecs_cluster.staging", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSClusterLoggingEnabled", "fixed_definition": null, "entity_tags": {"Environment": "staging", "Name": "social-media-api-staging"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-ecs-cluster-enables-logging-of-ecs-exec", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecs_cluster.staging", "path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_223", "bc_check_id": "BC_AWS_GENERAL_171", "check_name": "Ensure ECS Cluster enables logging of ECS Exec", "check_result": {"result": "PASSED", "evaluated_keys": ["configuration/[0]/execute_command_configuration/[0]/logging"]}, "code_block": [[102, "resource \"aws_ecs_cluster\" \"production\" {\n"], [103, "  name = \"${var.project_name}-production\"\n"], [104, "\n"], [105, "  setting {\n"], [106, "    name  = \"containerInsights\"\n"], [107, "    value = \"disabled\"  # Disabled to save costs\n"], [108, "  }\n"], [109, "\n"], [110, "  tags = {\n"], [111, "    Name        = \"${var.project_name}-production\"\n"], [112, "    Environment = \"production\"\n"], [113, "  }\n"], [114, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [102, 114], "resource": "aws_ecs_cluster.production", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSClusterLoggingEnabled", "fixed_definition": null, "entity_tags": {"Environment": "production", "Name": "social-media-api-production"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-ecs-cluster-enables-logging-of-ecs-exec", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecs_cluster.production", "path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_97", "bc_check_id": "BC_AWS_GENERAL_39", "check_name": "Ensure Encryption in transit is enabled for EFS volumes in ECS Task definitions", "check_result": {"result": "PASSED", "evaluated_keys": ["volume"]}, "code_block": [[117, "resource \"aws_ecs_task_definition\" \"app\" {\n"], [118, "  family                = var.project_name\n"], [119, "  network_mode          = \"bridge\"  # EC2 mode\n"], [120, "  task_role_arn         = aws_iam_role.ecs_task_execution.arn\n"], [121, "  execution_role_arn    = aws_iam_role.ecs_task_execution.arn\n"], [122, "\n"], [123, "  container_definitions = jsonencode([{\n"], [124, "    name      = \"social-media-app\"\n"], [125, "    image     = \"${aws_ecr_repository.app.repository_url}:latest\"\n"], [126, "    memory    = 400  # Leave some memory for system\n"], [127, "    essential = true\n"], [128, "    \n"], [129, "    portMappings = [{\n"], [130, "      containerPort = 8080\n"], [131, "      hostPort      = 8080\n"], [132, "      protocol      = \"tcp\"\n"], [133, "    }]\n"], [134, "\n"], [135, "    environment = [\n"], [136, "      {\n"], [137, "        name  = \"SPRING_DATASOURCE_URL\"\n"], [138, "        value = \"jdbc:postgresql://${aws_db_instance.postgres.address}:5432/social_media_db\"\n"], [139, "      },\n"], [140, "      {\n"], [141, "        name  = \"SPRING_DATASOURCE_USERNAME\"\n"], [142, "        value = var.db_username\n"], [143, "      },\n"], [144, "      {\n"], [145, "        name  = \"SPRING_DATASOURCE_PASSWORD\"\n"], [146, "        value = var.db_password\n"], [147, "      },\n"], [148, "      {\n"], [149, "        name  = \"SPRING_JPA_HIBERNATE_DDL_AUTO\"\n"], [150, "        value = \"update\"\n"], [151, "      }\n"], [152, "    ]\n"], [153, "\n"], [154, "    logConfiguration = {\n"], [155, "      logDriver = \"awslogs\"\n"], [156, "      options = {\n"], [157, "        \"awslogs-group\"         = \"/ecs/${var.project_name}\"\n"], [158, "        \"awslogs-region\"        = var.aws_region\n"], [159, "        \"awslogs-stream-prefix\" = \"ecs\"\n"], [160, "      }\n"], [161, "    }\n"], [162, "  }])\n"], [163, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [117, 163], "resource": "aws_ecs_task_definition.app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionEFSVolumeEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-39", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"container_definitions": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "family": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_334", "bc_check_id": "BC_AWS_GENERAL_239", "check_name": "Ensure ECS containers should run as non-privileged", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[117, "resource \"aws_ecs_task_definition\" \"app\" {\n"], [118, "  family                = var.project_name\n"], [119, "  network_mode          = \"bridge\"  # EC2 mode\n"], [120, "  task_role_arn         = aws_iam_role.ecs_task_execution.arn\n"], [121, "  execution_role_arn    = aws_iam_role.ecs_task_execution.arn\n"], [122, "\n"], [123, "  container_definitions = jsonencode([{\n"], [124, "    name      = \"social-media-app\"\n"], [125, "    image     = \"${aws_ecr_repository.app.repository_url}:latest\"\n"], [126, "    memory    = 400  # Leave some memory for system\n"], [127, "    essential = true\n"], [128, "    \n"], [129, "    portMappings = [{\n"], [130, "      containerPort = 8080\n"], [131, "      hostPort      = 8080\n"], [132, "      protocol      = \"tcp\"\n"], [133, "    }]\n"], [134, "\n"], [135, "    environment = [\n"], [136, "      {\n"], [137, "        name  = \"SPRING_DATASOURCE_URL\"\n"], [138, "        value = \"jdbc:postgresql://${aws_db_instance.postgres.address}:5432/social_media_db\"\n"], [139, "      },\n"], [140, "      {\n"], [141, "        name  = \"SPRING_DATASOURCE_USERNAME\"\n"], [142, "        value = var.db_username\n"], [143, "      },\n"], [144, "      {\n"], [145, "        name  = \"SPRING_DATASOURCE_PASSWORD\"\n"], [146, "        value = var.db_password\n"], [147, "      },\n"], [148, "      {\n"], [149, "        name  = \"SPRING_JPA_HIBERNATE_DDL_AUTO\"\n"], [150, "        value = \"update\"\n"], [151, "      }\n"], [152, "    ]\n"], [153, "\n"], [154, "    logConfiguration = {\n"], [155, "      logDriver = \"awslogs\"\n"], [156, "      options = {\n"], [157, "        \"awslogs-group\"         = \"/ecs/${var.project_name}\"\n"], [158, "        \"awslogs-region\"        = var.aws_region\n"], [159, "        \"awslogs-stream-prefix\" = \"ecs\"\n"], [160, "      }\n"], [161, "    }\n"], [162, "  }])\n"], [163, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [117, 163], "resource": "aws_ecs_task_definition.app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerPrivilege", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-334", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"container_definitions": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "family": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_335", "bc_check_id": "BC_AWS_GENERAL_240", "check_name": "Ensure ECS task definitions should not share the host's process namespace", "check_result": {"result": "PASSED", "evaluated_keys": ["container_definitions"]}, "code_block": [[117, "resource \"aws_ecs_task_definition\" \"app\" {\n"], [118, "  family                = var.project_name\n"], [119, "  network_mode          = \"bridge\"  # EC2 mode\n"], [120, "  task_role_arn         = aws_iam_role.ecs_task_execution.arn\n"], [121, "  execution_role_arn    = aws_iam_role.ecs_task_execution.arn\n"], [122, "\n"], [123, "  container_definitions = jsonencode([{\n"], [124, "    name      = \"social-media-app\"\n"], [125, "    image     = \"${aws_ecr_repository.app.repository_url}:latest\"\n"], [126, "    memory    = 400  # Leave some memory for system\n"], [127, "    essential = true\n"], [128, "    \n"], [129, "    portMappings = [{\n"], [130, "      containerPort = 8080\n"], [131, "      hostPort      = 8080\n"], [132, "      protocol      = \"tcp\"\n"], [133, "    }]\n"], [134, "\n"], [135, "    environment = [\n"], [136, "      {\n"], [137, "        name  = \"SPRING_DATASOURCE_URL\"\n"], [138, "        value = \"jdbc:postgresql://${aws_db_instance.postgres.address}:5432/social_media_db\"\n"], [139, "      },\n"], [140, "      {\n"], [141, "        name  = \"SPRING_DATASOURCE_USERNAME\"\n"], [142, "        value = var.db_username\n"], [143, "      },\n"], [144, "      {\n"], [145, "        name  = \"SPRING_DATASOURCE_PASSWORD\"\n"], [146, "        value = var.db_password\n"], [147, "      },\n"], [148, "      {\n"], [149, "        name  = \"SPRING_JPA_HIBERNATE_DDL_AUTO\"\n"], [150, "        value = \"update\"\n"], [151, "      }\n"], [152, "    ]\n"], [153, "\n"], [154, "    logConfiguration = {\n"], [155, "      logDriver = \"awslogs\"\n"], [156, "      options = {\n"], [157, "        \"awslogs-group\"         = \"/ecs/${var.project_name}\"\n"], [158, "        \"awslogs-region\"        = var.aws_region\n"], [159, "        \"awslogs-stream-prefix\" = \"ecs\"\n"], [160, "      }\n"], [161, "    }\n"], [162, "  }])\n"], [163, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [117, 163], "resource": "aws_ecs_task_definition.app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerHostProcess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-335", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"container_definitions": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "family": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[166, "resource \"aws_cloudwatch_log_group\" \"ecs\" {\n"], [167, "  name              = \"/ecs/${var.project_name}\"\n"], [168, "  retention_in_days = 1  # Minimum retention for free tier\n"], [169, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [166, 169], "resource": "aws_cloudwatch_log_group.ecs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_333", "bc_check_id": "BC_AWS_LOGGING_45", "check_name": "Ensure ECS services do not have public IP addresses assigned to them automatically", "check_result": {"result": "PASSED", "evaluated_keys": ["network_configuration/[0]/assign_public_ip"]}, "code_block": [[172, "resource \"aws_ecs_service\" \"staging\" {\n"], [173, "  name            = \"${var.project_name}-staging-service\"\n"], [174, "  cluster         = aws_ecs_cluster.staging.id\n"], [175, "  task_definition = aws_ecs_task_definition.app.arn\n"], [176, "  desired_count   = 1\n"], [177, "  launch_type     = \"EC2\"\n"], [178, "\n"], [179, "  # Deployment configuration for single EC2 instance with static ports\n"], [180, "  deployment_minimum_healthy_percent = 0    # Allow stopping old task before starting new one\n"], [181, "  deployment_maximum_percent         = 100  # Only run 1 task at a time\n"], [182, "\n"], [183, "  # Force new deployment on each update\n"], [184, "  force_new_deployment = true\n"], [185, "\n"], [186, "  depends_on = [\n"], [187, "    aws_autoscaling_group.ecs_staging\n"], [188, "  ]\n"], [189, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [172, 189], "resource": "aws_ecs_service.staging", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServicePublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-333", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_333", "bc_check_id": "BC_AWS_LOGGING_45", "check_name": "Ensure ECS services do not have public IP addresses assigned to them automatically", "check_result": {"result": "PASSED", "evaluated_keys": ["network_configuration/[0]/assign_public_ip"]}, "code_block": [[192, "resource \"aws_ecs_service\" \"production\" {\n"], [193, "  name            = \"${var.project_name}-prod-service\"\n"], [194, "  cluster         = aws_ecs_cluster.production.id\n"], [195, "  task_definition = aws_ecs_task_definition.app.arn\n"], [196, "  desired_count   = 1\n"], [197, "  launch_type     = \"EC2\"\n"], [198, "\n"], [199, "  # Deployment configuration for single EC2 instance with static ports\n"], [200, "  deployment_minimum_healthy_percent = 0    # Allow stopping old task before starting new one\n"], [201, "  deployment_maximum_percent         = 100  # Only run 1 task at a time\n"], [202, "\n"], [203, "  # Force new deployment on each update\n"], [204, "  force_new_deployment = true\n"], [205, "\n"], [206, "  depends_on = [\n"], [207, "    aws_autoscaling_group.ecs_production\n"], [208, "  ]\n"], [209, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [192, 209], "resource": "aws_ecs_service.production", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSServicePublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-333", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "resource \"aws_iam_role\" \"ecs_task_execution\" {\n"], [3, "  name = \"${var.project_name}-ecs-task-execution\"\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\"\n"], [7, "    Statement = [{\n"], [8, "      Action = \"sts:AssumeRole\"\n"], [9, "      Effect = \"Allow\"\n"], [10, "      Principal = {\n"], [11, "        Service = \"ecs-tasks.amazonaws.com\"\n"], [12, "      }\n"], [13, "    }]\n"], [14, "  })\n"], [15, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "repo_file_path": "/terraform/iam.tf", "file_line_range": [2, 15], "resource": "aws_iam_role.ecs_task_execution", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ecs_task_execution", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[2, "resource \"aws_iam_role\" \"ecs_task_execution\" {\n"], [3, "  name = \"${var.project_name}-ecs-task-execution\"\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\"\n"], [7, "    Statement = [{\n"], [8, "      Action = \"sts:AssumeRole\"\n"], [9, "      Effect = \"Allow\"\n"], [10, "      Principal = {\n"], [11, "        Service = \"ecs-tasks.amazonaws.com\"\n"], [12, "      }\n"], [13, "    }]\n"], [14, "  })\n"], [15, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "repo_file_path": "/terraform/iam.tf", "file_line_range": [2, 15], "resource": "aws_iam_role.ecs_task_execution", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ecs_task_execution", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[2, "resource \"aws_iam_role\" \"ecs_task_execution\" {\n"], [3, "  name = \"${var.project_name}-ecs-task-execution\"\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\"\n"], [7, "    Statement = [{\n"], [8, "      Action = \"sts:AssumeRole\"\n"], [9, "      Effect = \"Allow\"\n"], [10, "      Principal = {\n"], [11, "        Service = \"ecs-tasks.amazonaws.com\"\n"], [12, "      }\n"], [13, "    }]\n"], [14, "  })\n"], [15, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "repo_file_path": "/terraform/iam.tf", "file_line_range": [2, 15], "resource": "aws_iam_role.ecs_task_execution", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ecs_task_execution", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[17, "resource \"aws_iam_role_policy_attachment\" \"ecs_task_execution\" {\n"], [18, "  role       = aws_iam_role.ecs_task_execution.name\n"], [19, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\"\n"], [20, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "repo_file_path": "/terraform/iam.tf", "file_line_range": [17, 20], "resource": "aws_iam_role_policy_attachment.ecs_task_execution", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "breadcrumbs": {"role": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ecs_task_execution", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[23, "resource \"aws_iam_role\" \"ecs_instance\" {\n"], [24, "  name = \"${var.project_name}-ecs-instance-role\"\n"], [25, "\n"], [26, "  assume_role_policy = jsonencode({\n"], [27, "    Version = \"2012-10-17\"\n"], [28, "    Statement = [{\n"], [29, "      Action = \"sts:AssumeRole\"\n"], [30, "      Effect = \"Allow\"\n"], [31, "      Principal = {\n"], [32, "        Service = \"ec2.amazonaws.com\"\n"], [33, "      }\n"], [34, "    }]\n"], [35, "  })\n"], [36, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "repo_file_path": "/terraform/iam.tf", "file_line_range": [23, 36], "resource": "aws_iam_role.ecs_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ecs_instance", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[23, "resource \"aws_iam_role\" \"ecs_instance\" {\n"], [24, "  name = \"${var.project_name}-ecs-instance-role\"\n"], [25, "\n"], [26, "  assume_role_policy = jsonencode({\n"], [27, "    Version = \"2012-10-17\"\n"], [28, "    Statement = [{\n"], [29, "      Action = \"sts:AssumeRole\"\n"], [30, "      Effect = \"Allow\"\n"], [31, "      Principal = {\n"], [32, "        Service = \"ec2.amazonaws.com\"\n"], [33, "      }\n"], [34, "    }]\n"], [35, "  })\n"], [36, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "repo_file_path": "/terraform/iam.tf", "file_line_range": [23, 36], "resource": "aws_iam_role.ecs_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ecs_instance", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[23, "resource \"aws_iam_role\" \"ecs_instance\" {\n"], [24, "  name = \"${var.project_name}-ecs-instance-role\"\n"], [25, "\n"], [26, "  assume_role_policy = jsonencode({\n"], [27, "    Version = \"2012-10-17\"\n"], [28, "    Statement = [{\n"], [29, "      Action = \"sts:AssumeRole\"\n"], [30, "      Effect = \"Allow\"\n"], [31, "      Principal = {\n"], [32, "        Service = \"ec2.amazonaws.com\"\n"], [33, "      }\n"], [34, "    }]\n"], [35, "  })\n"], [36, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "repo_file_path": "/terraform/iam.tf", "file_line_range": [23, 36], "resource": "aws_iam_role.ecs_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ecs_instance", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[38, "resource \"aws_iam_role_policy_attachment\" \"ecs_instance\" {\n"], [39, "  role       = aws_iam_role.ecs_instance.name\n"], [40, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role\"\n"], [41, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "repo_file_path": "/terraform/iam.tf", "file_line_range": [38, 41], "resource": "aws_iam_role_policy_attachment.ecs_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "breadcrumbs": {"role": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ecs_instance", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_41", "bc_check_id": "BC_AWS_SECRETS_5", "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[12, "provider \"aws\" {\n"], [13, "  region = var.aws_region\n"], [14, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/main.tf", "repo_file_path": "/terraform/main.tf", "file_line_range": [12, 14], "resource": "aws.default", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/main.tf", "breadcrumbs": {"region": [{"type": "variable", "name": "aws_region", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[14, "resource \"aws_security_group\" \"rds\" {\n"], [15, "  name        = \"${var.project_name}-rds-sg\"\n"], [16, "  vpc_id      = aws_vpc.main.id\n"], [17, "  description = \"Security group for RDS PostgreSQL\"\n"], [18, "\n"], [19, "  ingress {\n"], [20, "    from_port       = 5432\n"], [21, "    to_port         = 5432\n"], [22, "    protocol        = \"tcp\"\n"], [23, "    security_groups = [aws_security_group.ecs.id]\n"], [24, "    description     = \"Allow PostgreSQL from ECS instances\"\n"], [25, "  }\n"], [26, "\n"], [27, "  egress {\n"], [28, "    from_port   = 0\n"], [29, "    to_port     = 0\n"], [30, "    protocol    = \"-1\"\n"], [31, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [32, "  }\n"], [33, "\n"], [34, "  tags = {\n"], [35, "    Name = \"${var.project_name}-rds-sg\"\n"], [36, "  }\n"], [37, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [14, 37], "resource": "aws_security_group.rds", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-rds-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[14, "resource \"aws_security_group\" \"rds\" {\n"], [15, "  name        = \"${var.project_name}-rds-sg\"\n"], [16, "  vpc_id      = aws_vpc.main.id\n"], [17, "  description = \"Security group for RDS PostgreSQL\"\n"], [18, "\n"], [19, "  ingress {\n"], [20, "    from_port       = 5432\n"], [21, "    to_port         = 5432\n"], [22, "    protocol        = \"tcp\"\n"], [23, "    security_groups = [aws_security_group.ecs.id]\n"], [24, "    description     = \"Allow PostgreSQL from ECS instances\"\n"], [25, "  }\n"], [26, "\n"], [27, "  egress {\n"], [28, "    from_port   = 0\n"], [29, "    to_port     = 0\n"], [30, "    protocol    = \"-1\"\n"], [31, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [32, "  }\n"], [33, "\n"], [34, "  tags = {\n"], [35, "    Name = \"${var.project_name}-rds-sg\"\n"], [36, "  }\n"], [37, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [14, 37], "resource": "aws_security_group.rds", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-rds-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[14, "resource \"aws_security_group\" \"rds\" {\n"], [15, "  name        = \"${var.project_name}-rds-sg\"\n"], [16, "  vpc_id      = aws_vpc.main.id\n"], [17, "  description = \"Security group for RDS PostgreSQL\"\n"], [18, "\n"], [19, "  ingress {\n"], [20, "    from_port       = 5432\n"], [21, "    to_port         = 5432\n"], [22, "    protocol        = \"tcp\"\n"], [23, "    security_groups = [aws_security_group.ecs.id]\n"], [24, "    description     = \"Allow PostgreSQL from ECS instances\"\n"], [25, "  }\n"], [26, "\n"], [27, "  egress {\n"], [28, "    from_port   = 0\n"], [29, "    to_port     = 0\n"], [30, "    protocol    = \"-1\"\n"], [31, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [32, "  }\n"], [33, "\n"], [34, "  tags = {\n"], [35, "    Name = \"${var.project_name}-rds-sg\"\n"], [36, "  }\n"], [37, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [14, 37], "resource": "aws_security_group.rds", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-rds-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[14, "resource \"aws_security_group\" \"rds\" {\n"], [15, "  name        = \"${var.project_name}-rds-sg\"\n"], [16, "  vpc_id      = aws_vpc.main.id\n"], [17, "  description = \"Security group for RDS PostgreSQL\"\n"], [18, "\n"], [19, "  ingress {\n"], [20, "    from_port       = 5432\n"], [21, "    to_port         = 5432\n"], [22, "    protocol        = \"tcp\"\n"], [23, "    security_groups = [aws_security_group.ecs.id]\n"], [24, "    description     = \"Allow PostgreSQL from ECS instances\"\n"], [25, "  }\n"], [26, "\n"], [27, "  egress {\n"], [28, "    from_port   = 0\n"], [29, "    to_port     = 0\n"], [30, "    protocol    = \"-1\"\n"], [31, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [32, "  }\n"], [33, "\n"], [34, "  tags = {\n"], [35, "    Name = \"${var.project_name}-rds-sg\"\n"], [36, "  }\n"], [37, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [14, 37], "resource": "aws_security_group.rds", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-rds-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_211", "bc_check_id": "BC_AWS_GENERAL_118", "check_name": "Ensure RDS uses a modern CaCert", "check_result": {"result": "PASSED", "evaluated_keys": ["ca_cert_identifier"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSCACertIsRecent", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-rds-uses-a-modern-cacert", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "PASSED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_354", "bc_check_id": "BC_AWS_GENERAL_254", "check_name": "Ensure RDS Performance Insights are encrypted using KMS CMKs", "check_result": {"result": "PASSED", "evaluated_keys": ["performance_insights_kms_key_id"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstancePerfInsightsEncryptionWithCMK", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-354", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_388", "bc_check_id": null, "check_name": "Ensure AWS Aurora PostgreSQL is not exposed to local file read vulnerability", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.UnpatchedAuroraPostgresDB", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_17", "bc_check_id": "BC_AWS_PUBLIC_2", "check_name": "Ensure all data stored in RDS is not publicly accessible", "check_result": {"result": "PASSED", "evaluated_keys": ["publicly_accessible"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSPubliclyAccessible", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-2", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_250", "bc_check_id": "BC_AWS_GENERAL_130", "check_name": "Ensure that RDS PostgreSQL instances use a non vulnerable version with the log_fdw extension (https://aws.amazon.com/security/security-bulletins/AWS-2022-004/)", "check_result": {"result": "PASSED", "evaluated_keys": ["engine", "engine_version"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSPostgreSQLLogFDWExtension", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-rds-postgresql-instances-use-a-non-vulnerable-version-of-log-fdw-extension", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_16", "bc_check_id": "BC_AWS_GENERAL_4", "check_name": "Ensure all data stored in the RDS is securely encrypted at rest", "check_result": {"result": "PASSED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSEncryption", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-4", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[2, "resource \"aws_s3_bucket\" \"reports\" {\n"], [3, "  bucket = \"${var.project_name}-reports-${data.aws_caller_identity.current.account_id}\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project_name}-reports\"\n"], [7, "    Environment = var.environment\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "repo_file_path": "/terraform/s3.tf", "file_line_range": [2, 9], "resource": "aws_s3_bucket.reports", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-reports"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/runner/work/Sample/Sample/terraform/main.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ecs_task_execution": {"__end_line__": 15, "__start_line__": 2, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ecs-tasks.amazonaws.com"}}]}], "name": ["social-media-api-ecs-task-execution"], "__address__": "aws_iam_role.ecs_task_execution"}}}, "evaluated_keys": ["policy_arn", "arn", "managed_policy_arn", "managed_policy_arns/*", "name"]}, "code_block": [[2, "resource \"aws_iam_role\" \"ecs_task_execution\" {\n"], [3, "  name = \"${var.project_name}-ecs-task-execution\"\n"], [4, "\n"], [5, "  assume_role_policy = jsonencode({\n"], [6, "    Version = \"2012-10-17\"\n"], [7, "    Statement = [{\n"], [8, "      Action = \"sts:AssumeRole\"\n"], [9, "      Effect = \"Allow\"\n"], [10, "      Principal = {\n"], [11, "        Service = \"ecs-tasks.amazonaws.com\"\n"], [12, "      }\n"], [13, "    }]\n"], [14, "  })\n"], [15, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "repo_file_path": "/terraform/iam.tf", "file_line_range": [2, 15], "resource": "aws_iam_role.ecs_task_execution", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ecs_task_execution", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ecs_task_execution": {"__end_line__": 20, "__start_line__": 17, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"], "role": ["social-media-api-ecs-task-execution"], "__address__": "aws_iam_role_policy_attachment.ecs_task_execution"}}}, "evaluated_keys": ["policy_arn", "arn", "managed_policy_arn", "managed_policy_arns/*", "name"]}, "code_block": [[17, "resource \"aws_iam_role_policy_attachment\" \"ecs_task_execution\" {\n"], [18, "  role       = aws_iam_role.ecs_task_execution.name\n"], [19, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\"\n"], [20, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "repo_file_path": "/terraform/iam.tf", "file_line_range": [17, 20], "resource": "aws_iam_role_policy_attachment.ecs_task_execution", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "breadcrumbs": {"role": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ecs_task_execution", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ecs_instance": {"__end_line__": 36, "__start_line__": 23, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ec2.amazonaws.com"}}]}], "name": ["social-media-api-ecs-instance-role"], "__address__": "aws_iam_role.ecs_instance"}}}, "evaluated_keys": ["policy_arn", "arn", "managed_policy_arn", "managed_policy_arns/*", "name"]}, "code_block": [[23, "resource \"aws_iam_role\" \"ecs_instance\" {\n"], [24, "  name = \"${var.project_name}-ecs-instance-role\"\n"], [25, "\n"], [26, "  assume_role_policy = jsonencode({\n"], [27, "    Version = \"2012-10-17\"\n"], [28, "    Statement = [{\n"], [29, "      Action = \"sts:AssumeRole\"\n"], [30, "      Effect = \"Allow\"\n"], [31, "      Principal = {\n"], [32, "        Service = \"ec2.amazonaws.com\"\n"], [33, "      }\n"], [34, "    }]\n"], [35, "  })\n"], [36, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "repo_file_path": "/terraform/iam.tf", "file_line_range": [23, 36], "resource": "aws_iam_role.ecs_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ecs_instance", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ecs_instance": {"__end_line__": 41, "__start_line__": 38, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role"], "role": ["social-media-api-ecs-instance-role"], "__address__": "aws_iam_role_policy_attachment.ecs_instance"}}}, "evaluated_keys": ["policy_arn", "arn", "managed_policy_arn", "managed_policy_arns/*", "name"]}, "code_block": [[38, "resource \"aws_iam_role_policy_attachment\" \"ecs_instance\" {\n"], [39, "  role       = aws_iam_role.ecs_instance.name\n"], [40, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceforEC2Role\"\n"], [41, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "repo_file_path": "/terraform/iam.tf", "file_line_range": [38, 41], "resource": "aws_iam_role_policy_attachment.ecs_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "breadcrumbs": {"role": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ecs_instance", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_44", "bc_check_id": "BC_AWS_NETWORKING_80", "check_name": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"public": {"__end_line__": 43, "__start_line__": 32, "route": [{"cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.main.id"]}], "tags": [{"Name": "social-media-api-public-rt"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_route_table.public"}}}, "evaluated_keys": ["route/*/vpc_peering_connection_id", "destination_cidr_block", "vpc_peering_connection_id", "route/*/cidr_block", "destination_ipv6_cidr_block", "route/*/ipv6_cidr_block"]}, "code_block": [[32, "resource \"aws_route_table\" \"public\" {\n"], [33, "  vpc_id = aws_vpc.main.id\n"], [34, "\n"], [35, "  route {\n"], [36, "    cidr_block = \"0.0.0.0/0\"\n"], [37, "    gateway_id = aws_internet_gateway.main.id\n"], [38, "  }\n"], [39, "\n"], [40, "  tags = {\n"], [41, "    Name = \"${var.project_name}-public-rt\"\n"], [42, "  }\n"], [43, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [32, 43], "resource": "aws_route_table.public", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-public-rt"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "PASSED", "entity": {"aws_security_group": {"ecs": {"__end_line__": 85, "__start_line__": 52, "description": ["Security group for ECS EC2 instances"], "egress": [{"cidr_blocks": [["0.0.0.0/0"]], "from_port": [0], "protocol": ["-1"], "to_port": [0]}], "ingress": [{"cidr_blocks": [["0.0.0.0/0"]], "description": ["Allow HTTP traffic to application"], "from_port": [8080], "protocol": ["tcp"], "to_port": [8080]}, {"cidr_blocks": [["0.0.0.0/0"]], "description": ["Allow SSH access"], "from_port": [22], "protocol": ["tcp"], "to_port": [22]}], "name": ["social-media-api-ecs-sg"], "tags": [{"Name": "social-media-api-ecs-sg"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_security_group.ecs"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[52, "resource \"aws_security_group\" \"ecs\" {\n"], [53, "  name        = \"${var.project_name}-ecs-sg\"\n"], [54, "  vpc_id      = aws_vpc.main.id\n"], [55, "  description = \"Security group for ECS EC2 instances\"\n"], [56, "\n"], [57, "  # Allow direct access to application port\n"], [58, "  ingress {\n"], [59, "    from_port   = 8080\n"], [60, "    to_port     = 8080\n"], [61, "    protocol    = \"tcp\"\n"], [62, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [63, "    description = \"Allow HTTP traffic to application\"\n"], [64, "  }\n"], [65, "\n"], [66, "  # Allow SSH for troubleshooting (restrict in production)\n"], [67, "  ingress {\n"], [68, "    from_port   = 22\n"], [69, "    to_port     = 22\n"], [70, "    protocol    = \"tcp\"\n"], [71, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [72, "    description = \"Allow SSH access\"\n"], [73, "  }\n"], [74, "\n"], [75, "  egress {\n"], [76, "    from_port   = 0\n"], [77, "    to_port     = 0\n"], [78, "    protocol    = \"-1\"\n"], [79, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name = \"${var.project_name}-ecs-sg\"\n"], [84, "  }\n"], [85, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [52, 85], "resource": "aws_security_group.ecs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-ecs-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "PASSED", "entity": {"aws_security_group": {"rds": {"__end_line__": 37, "__start_line__": 14, "description": ["Security group for RDS PostgreSQL"], "egress": [{"cidr_blocks": [["0.0.0.0/0"]], "from_port": [0], "protocol": ["-1"], "to_port": [0]}], "ingress": [{"description": ["Allow PostgreSQL from ECS instances"], "from_port": [5432], "protocol": ["tcp"], "security_groups": [["aws_security_group.ecs.id"]], "to_port": [5432]}], "name": ["social-media-api-rds-sg"], "tags": [{"Name": "social-media-api-rds-sg"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_security_group.rds"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[14, "resource \"aws_security_group\" \"rds\" {\n"], [15, "  name        = \"${var.project_name}-rds-sg\"\n"], [16, "  vpc_id      = aws_vpc.main.id\n"], [17, "  description = \"Security group for RDS PostgreSQL\"\n"], [18, "\n"], [19, "  ingress {\n"], [20, "    from_port       = 5432\n"], [21, "    to_port         = 5432\n"], [22, "    protocol        = \"tcp\"\n"], [23, "    security_groups = [aws_security_group.ecs.id]\n"], [24, "    description     = \"Allow PostgreSQL from ECS instances\"\n"], [25, "  }\n"], [26, "\n"], [27, "  egress {\n"], [28, "    from_port   = 0\n"], [29, "    to_port     = 0\n"], [30, "    protocol    = \"-1\"\n"], [31, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [32, "  }\n"], [33, "\n"], [34, "  tags = {\n"], [35, "    Name = \"${var.project_name}-rds-sg\"\n"], [36, "  }\n"], [37, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [14, 37], "resource": "aws_security_group.rds", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-rds-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_35", "bc_check_id": "BC_AWS_NETWORKING_77", "check_name": "AWS NAT Gateways should be utilized for the default route", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"public": {"__end_line__": 43, "__start_line__": 32, "route": [{"cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.main.id"]}], "tags": [{"Name": "social-media-api-public-rt"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_route_table.public"}}}, "evaluated_keys": ["destination_cidr_block", "route/*/cidr_block", "instance_id", "route/*/instance_id"]}, "code_block": [[32, "resource \"aws_route_table\" \"public\" {\n"], [33, "  vpc_id = aws_vpc.main.id\n"], [34, "\n"], [35, "  route {\n"], [36, "    cidr_block = \"0.0.0.0/0\"\n"], [37, "    gateway_id = aws_internet_gateway.main.id\n"], [38, "  }\n"], [39, "\n"], [40, "  tags = {\n"], [41, "    Name = \"${var.project_name}-public-rt\"\n"], [42, "  }\n"], [43, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [32, 43], "resource": "aws_route_table.public", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-public-rt"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"reports": {"__end_line__": 9, "__start_line__": 2, "bucket": ["social-media-api-reports-${data.aws_caller_identity.current.account_id}"], "tags": [{"Environment": "dev", "Name": "social-media-api-reports"}], "__address__": "aws_s3_bucket.reports"}}}, "evaluated_keys": ["acl", "access_control_policy", "resource_type", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant", "access_control_policy/grant/*/permission"]}, "code_block": [[2, "resource \"aws_s3_bucket\" \"reports\" {\n"], [3, "  bucket = \"${var.project_name}-reports-${data.aws_caller_identity.current.account_id}\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project_name}-reports\"\n"], [7, "    Environment = var.environment\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "repo_file_path": "/terraform/s3.tf", "file_line_range": [2, 9], "resource": "aws_s3_bucket.reports", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-reports"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/runner/work/Sample/Sample/terraform/main.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"reports": {"__end_line__": 9, "__start_line__": 2, "bucket": ["social-media-api-reports-${data.aws_caller_identity.current.account_id}"], "tags": [{"Environment": "dev", "Name": "social-media-api-reports"}], "__address__": "aws_s3_bucket.reports"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[2, "resource \"aws_s3_bucket\" \"reports\" {\n"], [3, "  bucket = \"${var.project_name}-reports-${data.aws_caller_identity.current.account_id}\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project_name}-reports\"\n"], [7, "    Environment = var.environment\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "repo_file_path": "/terraform/s3.tf", "file_line_range": [2, 9], "resource": "aws_s3_bucket.reports", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-reports"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/runner/work/Sample/Sample/terraform/main.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_69", "bc_check_id": "BC_AWS_NETWORKING_93", "check_name": "Ensure AWS RDS database instance configured with encryption in transit", "check_result": {"result": "PASSED", "entity": {"aws_db_instance": {"postgres": {"__end_line__": 78, "__start_line__": 40, "allocated_storage": [20], "backup_retention_period": [7], "backup_window": ["03:00-04:00"], "db_name": ["social_media_db"], "db_subnet_group_name": ["social-media-api-db-subnet-group"], "deletion_protection": [false], "enabled_cloudwatch_logs_exports": [[]], "engine": ["postgres"], "engine_version": ["15.14"], "final_snapshot_identifier": ["social-media-api-final-snapshot"], "identifier": ["social-media-api-db"], "instance_class": ["db.t3.micro"], "maintenance_window": ["mon:04:00-mon:05:00"], "monitoring_interval": [0], "multi_az": [false], "password": ["postgres"], "performance_insights_enabled": [false], "publicly_accessible": [false], "skip_final_snapshot": [true], "storage_encrypted": [true], "storage_type": ["gp2"], "tags": [{"Environment": "dev", "Name": "social-media-api-postgres"}], "username": ["postgres"], "vpc_security_group_ids": [["aws_security_group.rds.id"]], "__address__": "aws_db_instance.postgres"}}}, "evaluated_keys": ["family", "parameter[?(@/name=='require_secure_transport')]/value", "parameter[?(@/name=='db2comm')]/value", "resource_type", "parameter[?(@/name=='rds/force_ssl')]/value"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-69", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"reports": {"__end_line__": 9, "__start_line__": 2, "bucket": ["social-media-api-reports-${data.aws_caller_identity.current.account_id}"], "tags": [{"Environment": "dev", "Name": "social-media-api-reports"}], "__address__": "aws_s3_bucket.reports"}}}, "evaluated_keys": ["acl", "access_control_policy", "resource_type", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[2, "resource \"aws_s3_bucket\" \"reports\" {\n"], [3, "  bucket = \"${var.project_name}-reports-${data.aws_caller_identity.current.account_id}\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project_name}-reports\"\n"], [7, "    Environment = var.environment\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "repo_file_path": "/terraform/s3.tf", "file_line_range": [2, 9], "resource": "aws_s3_bucket.reports", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-reports"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/runner/work/Sample/Sample/terraform/main.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"reports": {"__end_line__": 9, "__start_line__": 2, "bucket": ["social-media-api-reports-${data.aws_caller_identity.current.account_id}"], "tags": [{"Environment": "dev", "Name": "social-media-api-reports"}], "__address__": "aws_s3_bucket.reports"}}}, "evaluated_keys": ["server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[2, "resource \"aws_s3_bucket\" \"reports\" {\n"], [3, "  bucket = \"${var.project_name}-reports-${data.aws_caller_identity.current.account_id}\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project_name}-reports\"\n"], [7, "    Environment = var.environment\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "repo_file_path": "/terraform/s3.tf", "file_line_range": [2, 9], "resource": "aws_s3_bucket.reports", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-reports"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/runner/work/Sample/Sample/terraform/main.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"reports": {"__end_line__": 9, "__start_line__": 2, "bucket": ["social-media-api-reports-${data.aws_caller_identity.current.account_id}"], "tags": [{"Environment": "dev", "Name": "social-media-api-reports"}], "__address__": "aws_s3_bucket.reports"}}}, "evaluated_keys": ["versioning_configuration/status", "versioning/enabled", "resource_type"]}, "code_block": [[2, "resource \"aws_s3_bucket\" \"reports\" {\n"], [3, "  bucket = \"${var.project_name}-reports-${data.aws_caller_identity.current.account_id}\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project_name}-reports\"\n"], [7, "    Environment = var.environment\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "repo_file_path": "/terraform/s3.tf", "file_line_range": [2, 9], "resource": "aws_s3_bucket.reports", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-reports"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/runner/work/Sample/Sample/terraform/main.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}], "failed_checks": [{"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["metadata_options/[0]/http_tokens"]}, "code_block": [[18, "resource \"aws_launch_template\" \"ecs_staging\" {\n"], [19, "  name_prefix   = \"${var.project_name}-staging-\"\n"], [20, "  image_id      = data.aws_ami.ecs_optimized.id\n"], [21, "  instance_type = \"t2.micro\"  # FREE TIER!\n"], [22, "\n"], [23, "  iam_instance_profile {\n"], [24, "    name = aws_iam_instance_profile.ecs.name\n"], [25, "  }\n"], [26, "\n"], [27, "  vpc_security_group_ids = [aws_security_group.ecs.id]\n"], [28, "\n"], [29, "  user_data = base64encode(<<-EOF\n"], [30, "              #!/bin/bash\n"], [31, "              echo ECS_CLUSTER=${aws_ecs_cluster.staging.name} >> /etc/ecs/ecs.config\n"], [32, "              EOF\n"], [33, "  )\n"], [34, "\n"], [35, "  monitoring {\n"], [36, "    enabled = false  # Detailed monitoring costs extra\n"], [37, "  }\n"], [38, "\n"], [39, "  tag_specifications {\n"], [40, "    resource_type = \"instance\"\n"], [41, "    tags = {\n"], [42, "      Name = \"${var.project_name}-staging-ecs-instance\"\n"], [43, "    }\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [18, 45], "resource": "aws_launch_template.ecs_staging", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "breadcrumbs": {"name_prefix": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "user_data": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecs_cluster.staging", "path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "module_connection": false}], "iam_instance_profile.name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ecs", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["metadata_options/[0]/http_tokens"]}, "code_block": [[74, "resource \"aws_launch_template\" \"ecs_production\" {\n"], [75, "  name_prefix   = \"${var.project_name}-prod-\"\n"], [76, "  image_id      = data.aws_ami.ecs_optimized.id\n"], [77, "  instance_type = \"t2.micro\"  # FREE TIER!\n"], [78, "\n"], [79, "  iam_instance_profile {\n"], [80, "    name = aws_iam_instance_profile.ecs.name\n"], [81, "  }\n"], [82, "\n"], [83, "  vpc_security_group_ids = [aws_security_group.ecs.id]\n"], [84, "\n"], [85, "  user_data = base64encode(<<-EOF\n"], [86, "              #!/bin/bash\n"], [87, "              echo ECS_CLUSTER=${aws_ecs_cluster.production.name} >> /etc/ecs/ecs.config\n"], [88, "              EOF\n"], [89, "  )\n"], [90, "\n"], [91, "  monitoring {\n"], [92, "    enabled = false  # Detailed monitoring costs extra\n"], [93, "  }\n"], [94, "\n"], [95, "  tag_specifications {\n"], [96, "    resource_type = \"instance\"\n"], [97, "    tags = {\n"], [98, "      Name = \"${var.project_name}-production-ecs-instance\"\n"], [99, "    }\n"], [100, "  }\n"], [101, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "repo_file_path": "/terraform/ec2.tf", "file_line_range": [74, 101], "resource": "aws_launch_template.ecs_production", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ec2.tf", "breadcrumbs": {"name_prefix": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tag_specifications.tags": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "user_data": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecs_cluster.production", "path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "module_connection": false}], "iam_instance_profile.name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ecs", "path": "/home/runner/work/Sample/Sample/terraform/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_136", "bc_check_id": "BC_AWS_GENERAL_53", "check_name": "Ensure that ECR repositories are encrypted using KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["encryption_configuration/[0]/encryption_type"]}, "code_block": [[2, "resource \"aws_ecr_repository\" \"app\" {\n"], [3, "  name                 = var.project_name\n"], [4, "  image_tag_mutability = \"MUTABLE\"\n"], [5, "\n"], [6, "  image_scanning_configuration {\n"], [7, "    scan_on_push = true\n"], [8, "  }\n"], [9, "\n"], [10, "  tags = {\n"], [11, "    Name        = var.project_name\n"], [12, "    Environment = var.environment\n"], [13, "  }\n"], [14, "}\n"]], "file_path": "/ecr.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecr.tf", "repo_file_path": "/terraform/ecr.tf", "file_line_range": [2, 14], "resource": "aws_ecr_repository.app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECRRepositoryEncrypted", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ecr-repositories-are-encrypted", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecr.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecr_repository.app", "path": "/home/runner/work/Sample/Sample/terraform/ecr.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_51", "bc_check_id": "BC_AWS_GENERAL_24", "check_name": "Ensure ECR Image Tags are immutable", "check_result": {"result": "FAILED", "evaluated_keys": ["image_tag_mutability"]}, "code_block": [[2, "resource \"aws_ecr_repository\" \"app\" {\n"], [3, "  name                 = var.project_name\n"], [4, "  image_tag_mutability = \"MUTABLE\"\n"], [5, "\n"], [6, "  image_scanning_configuration {\n"], [7, "    scan_on_push = true\n"], [8, "  }\n"], [9, "\n"], [10, "  tags = {\n"], [11, "    Name        = var.project_name\n"], [12, "    Environment = var.environment\n"], [13, "  }\n"], [14, "}\n"]], "file_path": "/ecr.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecr.tf", "repo_file_path": "/terraform/ecr.tf", "file_line_range": [2, 14], "resource": "aws_ecr_repository.app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECRImmutableTags", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-24", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecr.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecr_repository.app", "path": "/home/runner/work/Sample/Sample/terraform/ecr.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[12, "resource \"aws_subnet\" \"public\" {\n"], [13, "  count                   = 2\n"], [14, "  vpc_id                  = aws_vpc.main.id\n"], [15, "  cidr_block              = \"10.0.${count.index + 1}.0/24\"\n"], [16, "  availability_zone       = data.aws_availability_zones.available.names[count.index]\n"], [17, "  map_public_ip_on_launch = true\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name = \"${var.project_name}-public-${count.index + 1}\"\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [12, 22], "resource": "aws_subnet.public[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-public-${0 + 1}"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "FAILED", "evaluated_keys": ["ingress/[1]/from_port", "ingress/[1]/to_port", "ingress/[1]/cidr_blocks", "ingress/[1]/ipv6_cidr_blocks"]}, "code_block": [[52, "resource \"aws_security_group\" \"ecs\" {\n"], [53, "  name        = \"${var.project_name}-ecs-sg\"\n"], [54, "  vpc_id      = aws_vpc.main.id\n"], [55, "  description = \"Security group for ECS EC2 instances\"\n"], [56, "\n"], [57, "  # Allow direct access to application port\n"], [58, "  ingress {\n"], [59, "    from_port   = 8080\n"], [60, "    to_port     = 8080\n"], [61, "    protocol    = \"tcp\"\n"], [62, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [63, "    description = \"Allow HTTP traffic to application\"\n"], [64, "  }\n"], [65, "\n"], [66, "  # Allow SSH for troubleshooting (restrict in production)\n"], [67, "  ingress {\n"], [68, "    from_port   = 22\n"], [69, "    to_port     = 22\n"], [70, "    protocol    = \"tcp\"\n"], [71, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [72, "    description = \"Allow SSH access\"\n"], [73, "  }\n"], [74, "\n"], [75, "  egress {\n"], [76, "    from_port   = 0\n"], [77, "    to_port     = 0\n"], [78, "    protocol    = \"-1\"\n"], [79, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name = \"${var.project_name}-ecs-sg\"\n"], [84, "  }\n"], [85, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [52, 85], "resource": "aws_security_group.ecs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-ecs-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "FAILED", "evaluated_keys": ["description", "egress/[0]"]}, "code_block": [[52, "resource \"aws_security_group\" \"ecs\" {\n"], [53, "  name        = \"${var.project_name}-ecs-sg\"\n"], [54, "  vpc_id      = aws_vpc.main.id\n"], [55, "  description = \"Security group for ECS EC2 instances\"\n"], [56, "\n"], [57, "  # Allow direct access to application port\n"], [58, "  ingress {\n"], [59, "    from_port   = 8080\n"], [60, "    to_port     = 8080\n"], [61, "    protocol    = \"tcp\"\n"], [62, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [63, "    description = \"Allow HTTP traffic to application\"\n"], [64, "  }\n"], [65, "\n"], [66, "  # Allow SSH for troubleshooting (restrict in production)\n"], [67, "  ingress {\n"], [68, "    from_port   = 22\n"], [69, "    to_port     = 22\n"], [70, "    protocol    = \"tcp\"\n"], [71, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [72, "    description = \"Allow SSH access\"\n"], [73, "  }\n"], [74, "\n"], [75, "  egress {\n"], [76, "    from_port   = 0\n"], [77, "    to_port     = 0\n"], [78, "    protocol    = \"-1\"\n"], [79, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name = \"${var.project_name}-ecs-sg\"\n"], [84, "  }\n"], [85, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [52, 85], "resource": "aws_security_group.ecs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-ecs-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["egress/[0]/from_port", "egress/[0]/to_port", "egress/[0]/cidr_blocks", "egress/[0]/ipv6_cidr_blocks"]}, "code_block": [[52, "resource \"aws_security_group\" \"ecs\" {\n"], [53, "  name        = \"${var.project_name}-ecs-sg\"\n"], [54, "  vpc_id      = aws_vpc.main.id\n"], [55, "  description = \"Security group for ECS EC2 instances\"\n"], [56, "\n"], [57, "  # Allow direct access to application port\n"], [58, "  ingress {\n"], [59, "    from_port   = 8080\n"], [60, "    to_port     = 8080\n"], [61, "    protocol    = \"tcp\"\n"], [62, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [63, "    description = \"Allow HTTP traffic to application\"\n"], [64, "  }\n"], [65, "\n"], [66, "  # Allow SSH for troubleshooting (restrict in production)\n"], [67, "  ingress {\n"], [68, "    from_port   = 22\n"], [69, "    to_port     = 22\n"], [70, "    protocol    = \"tcp\"\n"], [71, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [72, "    description = \"Allow SSH access\"\n"], [73, "  }\n"], [74, "\n"], [75, "  egress {\n"], [76, "    from_port   = 0\n"], [77, "    to_port     = 0\n"], [78, "    protocol    = \"-1\"\n"], [79, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [80, "  }\n"], [81, "\n"], [82, "  tags = {\n"], [83, "    Name = \"${var.project_name}-ecs-sg\"\n"], [84, "  }\n"], [85, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [52, 85], "resource": "aws_security_group.ecs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-ecs-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_65", "bc_check_id": "BC_AWS_LOGGING_11", "check_name": "Ensure container insights are enabled on ECS cluster", "check_result": {"result": "FAILED", "evaluated_keys": ["setting/[0]/name", "setting/[0]/value"]}, "code_block": [[88, "resource \"aws_ecs_cluster\" \"staging\" {\n"], [89, "  name = \"${var.project_name}-staging\"\n"], [90, "\n"], [91, "  setting {\n"], [92, "    name  = \"containerInsights\"\n"], [93, "    value = \"disabled\"  # Disabled to save costs\n"], [94, "  }\n"], [95, "\n"], [96, "  tags = {\n"], [97, "    Name        = \"${var.project_name}-staging\"\n"], [98, "    Environment = \"staging\"\n"], [99, "  }\n"], [100, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [88, 100], "resource": "aws_ecs_cluster.staging", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSClusterContainerInsights", "fixed_definition": null, "entity_tags": {"Environment": "staging", "Name": "social-media-api-staging"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-11", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecs_cluster.staging", "path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_65", "bc_check_id": "BC_AWS_LOGGING_11", "check_name": "Ensure container insights are enabled on ECS cluster", "check_result": {"result": "FAILED", "evaluated_keys": ["setting/[0]/name", "setting/[0]/value"]}, "code_block": [[102, "resource \"aws_ecs_cluster\" \"production\" {\n"], [103, "  name = \"${var.project_name}-production\"\n"], [104, "\n"], [105, "  setting {\n"], [106, "    name  = \"containerInsights\"\n"], [107, "    value = \"disabled\"  # Disabled to save costs\n"], [108, "  }\n"], [109, "\n"], [110, "  tags = {\n"], [111, "    Name        = \"${var.project_name}-production\"\n"], [112, "    Environment = \"production\"\n"], [113, "  }\n"], [114, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [102, 114], "resource": "aws_ecs_cluster.production", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSClusterContainerInsights", "fixed_definition": null, "entity_tags": {"Environment": "production", "Name": "social-media-api-production"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-11", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecs_cluster.production", "path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_336", "bc_check_id": "BC_AWS_GENERAL_241", "check_name": "Ensure ECS containers are limited to read-only access to root filesystems", "check_result": {"result": "FAILED", "evaluated_keys": ["container_definitions/[0]/[0]/readonlyRootFilesystem"]}, "code_block": [[117, "resource \"aws_ecs_task_definition\" \"app\" {\n"], [118, "  family                = var.project_name\n"], [119, "  network_mode          = \"bridge\"  # EC2 mode\n"], [120, "  task_role_arn         = aws_iam_role.ecs_task_execution.arn\n"], [121, "  execution_role_arn    = aws_iam_role.ecs_task_execution.arn\n"], [122, "\n"], [123, "  container_definitions = jsonencode([{\n"], [124, "    name      = \"social-media-app\"\n"], [125, "    image     = \"${aws_ecr_repository.app.repository_url}:latest\"\n"], [126, "    memory    = 400  # Leave some memory for system\n"], [127, "    essential = true\n"], [128, "    \n"], [129, "    portMappings = [{\n"], [130, "      containerPort = 8080\n"], [131, "      hostPort      = 8080\n"], [132, "      protocol      = \"tcp\"\n"], [133, "    }]\n"], [134, "\n"], [135, "    environment = [\n"], [136, "      {\n"], [137, "        name  = \"SPRING_DATASOURCE_URL\"\n"], [138, "        value = \"jdbc:postgresql://${aws_db_instance.postgres.address}:5432/social_media_db\"\n"], [139, "      },\n"], [140, "      {\n"], [141, "        name  = \"SPRING_DATASOURCE_USERNAME\"\n"], [142, "        value = var.db_username\n"], [143, "      },\n"], [144, "      {\n"], [145, "        name  = \"SPRING_DATASOURCE_PASSWORD\"\n"], [146, "        value = var.db_password\n"], [147, "      },\n"], [148, "      {\n"], [149, "        name  = \"SPRING_JPA_HIBERNATE_DDL_AUTO\"\n"], [150, "        value = \"update\"\n"], [151, "      }\n"], [152, "    ]\n"], [153, "\n"], [154, "    logConfiguration = {\n"], [155, "      logDriver = \"awslogs\"\n"], [156, "      options = {\n"], [157, "        \"awslogs-group\"         = \"/ecs/${var.project_name}\"\n"], [158, "        \"awslogs-region\"        = var.aws_region\n"], [159, "        \"awslogs-stream-prefix\" = \"ecs\"\n"], [160, "      }\n"], [161, "    }\n"], [162, "  }])\n"], [163, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [117, 163], "resource": "aws_ecs_task_definition.app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSContainerReadOnlyRoot", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-336", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"container_definitions": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "family": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_249", "bc_check_id": "BC_AWS_IAM_68", "check_name": "Ensure that the Execution Role ARN and the Task Role ARN are different in ECS Task definitions", "check_result": {"result": "FAILED", "evaluated_keys": ["execution_role_arn", "task_role_arn"]}, "code_block": [[117, "resource \"aws_ecs_task_definition\" \"app\" {\n"], [118, "  family                = var.project_name\n"], [119, "  network_mode          = \"bridge\"  # EC2 mode\n"], [120, "  task_role_arn         = aws_iam_role.ecs_task_execution.arn\n"], [121, "  execution_role_arn    = aws_iam_role.ecs_task_execution.arn\n"], [122, "\n"], [123, "  container_definitions = jsonencode([{\n"], [124, "    name      = \"social-media-app\"\n"], [125, "    image     = \"${aws_ecr_repository.app.repository_url}:latest\"\n"], [126, "    memory    = 400  # Leave some memory for system\n"], [127, "    essential = true\n"], [128, "    \n"], [129, "    portMappings = [{\n"], [130, "      containerPort = 8080\n"], [131, "      hostPort      = 8080\n"], [132, "      protocol      = \"tcp\"\n"], [133, "    }]\n"], [134, "\n"], [135, "    environment = [\n"], [136, "      {\n"], [137, "        name  = \"SPRING_DATASOURCE_URL\"\n"], [138, "        value = \"jdbc:postgresql://${aws_db_instance.postgres.address}:5432/social_media_db\"\n"], [139, "      },\n"], [140, "      {\n"], [141, "        name  = \"SPRING_DATASOURCE_USERNAME\"\n"], [142, "        value = var.db_username\n"], [143, "      },\n"], [144, "      {\n"], [145, "        name  = \"SPRING_DATASOURCE_PASSWORD\"\n"], [146, "        value = var.db_password\n"], [147, "      },\n"], [148, "      {\n"], [149, "        name  = \"SPRING_JPA_HIBERNATE_DDL_AUTO\"\n"], [150, "        value = \"update\"\n"], [151, "      }\n"], [152, "    ]\n"], [153, "\n"], [154, "    logConfiguration = {\n"], [155, "      logDriver = \"awslogs\"\n"], [156, "      options = {\n"], [157, "        \"awslogs-group\"         = \"/ecs/${var.project_name}\"\n"], [158, "        \"awslogs-region\"        = var.aws_region\n"], [159, "        \"awslogs-stream-prefix\" = \"ecs\"\n"], [160, "      }\n"], [161, "    }\n"], [162, "  }])\n"], [163, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [117, 163], "resource": "aws_ecs_task_definition.app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECSTaskDefinitionRoleCheck", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-the-aws-execution-role-arn-and-task-role-arn-are-different-in-ecs-task-definitions", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"container_definitions": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "family": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[166, "resource \"aws_cloudwatch_log_group\" \"ecs\" {\n"], [167, "  name              = \"/ecs/${var.project_name}\"\n"], [168, "  retention_in_days = 1  # Minimum retention for free tier\n"], [169, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [166, 169], "resource": "aws_cloudwatch_log_group.ecs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[166, "resource \"aws_cloudwatch_log_group\" \"ecs\" {\n"], [167, "  name              = \"/ecs/${var.project_name}\"\n"], [168, "  retention_in_days = 1  # Minimum retention for free tier\n"], [169, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [166, 169], "resource": "aws_cloudwatch_log_group.ecs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[12, "resource \"aws_subnet\" \"public\" {\n"], [13, "  count                   = 2\n"], [14, "  vpc_id                  = aws_vpc.main.id\n"], [15, "  cidr_block              = \"10.0.${count.index + 1}.0/24\"\n"], [16, "  availability_zone       = data.aws_availability_zones.available.names[count.index]\n"], [17, "  map_public_ip_on_launch = true\n"], [18, "\n"], [19, "  tags = {\n"], [20, "    Name = \"${var.project_name}-public-${count.index + 1}\"\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [12, 22], "resource": "aws_subnet.public[1]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-public-${1 + 1}"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "FAILED", "evaluated_keys": ["description", "egress/[0]"]}, "code_block": [[14, "resource \"aws_security_group\" \"rds\" {\n"], [15, "  name        = \"${var.project_name}-rds-sg\"\n"], [16, "  vpc_id      = aws_vpc.main.id\n"], [17, "  description = \"Security group for RDS PostgreSQL\"\n"], [18, "\n"], [19, "  ingress {\n"], [20, "    from_port       = 5432\n"], [21, "    to_port         = 5432\n"], [22, "    protocol        = \"tcp\"\n"], [23, "    security_groups = [aws_security_group.ecs.id]\n"], [24, "    description     = \"Allow PostgreSQL from ECS instances\"\n"], [25, "  }\n"], [26, "\n"], [27, "  egress {\n"], [28, "    from_port   = 0\n"], [29, "    to_port     = 0\n"], [30, "    protocol    = \"-1\"\n"], [31, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [32, "  }\n"], [33, "\n"], [34, "  tags = {\n"], [35, "    Name = \"${var.project_name}-rds-sg\"\n"], [36, "  }\n"], [37, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [14, 37], "resource": "aws_security_group.rds", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-rds-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "FAILED", "evaluated_keys": ["egress/[0]/from_port", "egress/[0]/to_port", "egress/[0]/cidr_blocks", "egress/[0]/ipv6_cidr_blocks"]}, "code_block": [[14, "resource \"aws_security_group\" \"rds\" {\n"], [15, "  name        = \"${var.project_name}-rds-sg\"\n"], [16, "  vpc_id      = aws_vpc.main.id\n"], [17, "  description = \"Security group for RDS PostgreSQL\"\n"], [18, "\n"], [19, "  ingress {\n"], [20, "    from_port       = 5432\n"], [21, "    to_port         = 5432\n"], [22, "    protocol        = \"tcp\"\n"], [23, "    security_groups = [aws_security_group.ecs.id]\n"], [24, "    description     = \"Allow PostgreSQL from ECS instances\"\n"], [25, "  }\n"], [26, "\n"], [27, "  egress {\n"], [28, "    from_port   = 0\n"], [29, "    to_port     = 0\n"], [30, "    protocol    = \"-1\"\n"], [31, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [32, "  }\n"], [33, "\n"], [34, "  tags = {\n"], [35, "    Name = \"${var.project_name}-rds-sg\"\n"], [36, "  }\n"], [37, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [14, 37], "resource": "aws_security_group.rds", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-rds-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_226", "bc_check_id": "BC_AWS_GENERAL_121", "check_name": "Ensure DB instance gets all minor upgrades automatically", "check_result": {"result": "FAILED", "evaluated_keys": ["auto_minor_version_upgrade"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceMinorUpgrade", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_157", "bc_check_id": "BC_AWS_GENERAL_73", "check_name": "Ensure that RDS instances have Multi-AZ enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["multi_az"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSMultiAZEnabled", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-73", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_118", "bc_check_id": "BC_AWS_LOGGING_28", "check_name": "Ensure that enhanced monitoring is enabled for Amazon RDS instances", "check_result": {"result": "FAILED", "evaluated_keys": ["monitoring_interval"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSEnhancedMonitorEnabled", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_353", "bc_check_id": "BC_AWS_LOGGING_47", "check_name": "Ensure that RDS instances have performance insights enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["performance_insights_enabled"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstancePerformanceInsights", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-353", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_293", "bc_check_id": "BC_AWS_GENERAL_208", "check_name": "Ensure that AWS database instances have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstanceDeletionProtection", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-293", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_161", "bc_check_id": "BC_AWS_IAM_65", "check_name": "Ensure RDS database has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSIAMAuthentication", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-rds-database-has-iam-authentication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_129", "bc_check_id": "BC_AWS_IAM_60", "check_name": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceLogging", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_300", "bc_check_id": "BC_AWS_GENERAL_214", "check_name": "Ensure S3 lifecycle configuration sets period for aborting failed uploads", "check_result": {"result": "FAILED", "evaluated_keys": ["rule"]}, "code_block": [[19, "resource \"aws_s3_bucket_lifecycle_configuration\" \"reports\" {\n"], [20, "  bucket = aws_s3_bucket.reports.id\n"], [21, "\n"], [22, "  rule {\n"], [23, "    id     = \"delete-old-reports\"\n"], [24, "    status = \"Enabled\"\n"], [25, "\n"], [26, "    expiration {\n"], [27, "      days = 30\n"], [28, "    }\n"], [29, "  }\n"], [30, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "repo_file_path": "/terraform/s3.tf", "file_line_range": [19, 30], "resource": "aws_s3_bucket_lifecycle_configuration.reports", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3AbortIncompleteUploads", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-300", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/s3.tf"}, {"check_id": "CKV2_AWS_60", "bc_check_id": "BC_AWS_GENERAL_195", "check_name": "Ensure RDS instance with copy tags to snapshots is enabled", "check_result": {"result": "FAILED", "entity": {"aws_db_instance": {"postgres": {"__end_line__": 78, "__start_line__": 40, "allocated_storage": [20], "backup_retention_period": [7], "backup_window": ["03:00-04:00"], "db_name": ["social_media_db"], "db_subnet_group_name": ["social-media-api-db-subnet-group"], "deletion_protection": [false], "enabled_cloudwatch_logs_exports": [[]], "engine": ["postgres"], "engine_version": ["15.14"], "final_snapshot_identifier": ["social-media-api-final-snapshot"], "identifier": ["social-media-api-db"], "instance_class": ["db.t3.micro"], "maintenance_window": ["mon:04:00-mon:05:00"], "monitoring_interval": [0], "multi_az": [false], "password": ["postgres"], "performance_insights_enabled": [false], "publicly_accessible": [false], "skip_final_snapshot": [true], "storage_encrypted": [true], "storage_type": ["gp2"], "tags": [{"Environment": "dev", "Name": "social-media-api-postgres"}], "username": ["postgres"], "vpc_security_group_ids": [["aws_security_group.rds.id"]], "__address__": "aws_db_instance.postgres"}}}, "evaluated_keys": ["engine", "copy_tags_to_snapshot"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"reports": {"__end_line__": 9, "__start_line__": 2, "bucket": ["social-media-api-reports-${data.aws_caller_identity.current.account_id}"], "tags": [{"Environment": "dev", "Name": "social-media-api-reports"}], "__address__": "aws_s3_bucket.reports"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[2, "resource \"aws_s3_bucket\" \"reports\" {\n"], [3, "  bucket = \"${var.project_name}-reports-${data.aws_caller_identity.current.account_id}\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project_name}-reports\"\n"], [7, "    Environment = var.environment\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "repo_file_path": "/terraform/s3.tf", "file_line_range": [2, 9], "resource": "aws_s3_bucket.reports", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-reports"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/runner/work/Sample/Sample/terraform/main.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_30", "bc_check_id": "BC_AWS_LOGGING_32", "check_name": "Ensure Postgres RDS as aws_db_instance has Query Logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_db_instance": {"postgres": {"__end_line__": 78, "__start_line__": 40, "allocated_storage": [20], "backup_retention_period": [7], "backup_window": ["03:00-04:00"], "db_name": ["social_media_db"], "db_subnet_group_name": ["social-media-api-db-subnet-group"], "deletion_protection": [false], "enabled_cloudwatch_logs_exports": [[]], "engine": ["postgres"], "engine_version": ["15.14"], "final_snapshot_identifier": ["social-media-api-final-snapshot"], "identifier": ["social-media-api-db"], "instance_class": ["db.t3.micro"], "maintenance_window": ["mon:04:00-mon:05:00"], "monitoring_interval": [0], "multi_az": [false], "password": ["postgres"], "performance_insights_enabled": [false], "publicly_accessible": [false], "skip_final_snapshot": [true], "storage_encrypted": [true], "storage_type": ["gp2"], "tags": [{"Environment": "dev", "Name": "social-media-api-postgres"}], "username": ["postgres"], "vpc_security_group_ids": [["aws_security_group.rds.id"]], "__address__": "aws_db_instance.postgres"}}}, "evaluated_keys": ["engine", "resource_type", "parameter/*/name"]}, "code_block": [[40, "resource \"aws_db_instance\" \"postgres\" {\n"], [41, "  identifier        = \"${var.project_name}-db\"\n"], [42, "  engine            = \"postgres\"\n"], [43, "  engine_version    = \"15.14\"  # Latest available in eu-west-3\n"], [44, "  instance_class    = \"db.t3.micro\"  # FREE TIER: 750 hours/month\n"], [45, "  allocated_storage = 20              # FREE TIER: 20GB\n"], [46, "\n"], [47, "  db_name  = \"social_media_db\"\n"], [48, "  username = var.db_username\n"], [49, "  password = var.db_password\n"], [50, "\n"], [51, "  db_subnet_group_name   = aws_db_subnet_group.main.name\n"], [52, "  vpc_security_group_ids = [aws_security_group.rds.id]\n"], [53, "  publicly_accessible    = false\n"], [54, "\n"], [55, "  # Free tier optimizations\n"], [56, "  storage_type          = \"gp2\"\n"], [57, "  backup_retention_period = 7\n"], [58, "  backup_window          = \"03:00-04:00\"\n"], [59, "  maintenance_window     = \"mon:04:00-mon:05:00\"\n"], [60, "  \n"], [61, "  skip_final_snapshot       = true  # Change to false for production\n"], [62, "  final_snapshot_identifier = \"${var.project_name}-final-snapshot\"\n"], [63, "  \n"], [64, "  # Disable features that cost extra\n"], [65, "  enabled_cloudwatch_logs_exports = []\n"], [66, "  performance_insights_enabled    = false\n"], [67, "  monitoring_interval             = 0\n"], [68, "  \n"], [69, "  # Free tier eligible options\n"], [70, "  multi_az               = false  # Single AZ for free tier\n"], [71, "  deletion_protection    = false  # Set to true for production\n"], [72, "  storage_encrypted      = true\n"], [73, "\n"], [74, "  tags = {\n"], [75, "    Name        = \"${var.project_name}-postgres\"\n"], [76, "    Environment = var.environment\n"], [77, "  }\n"], [78, "}\n"]], "file_path": "/rds.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "repo_file_path": "/terraform/rds.tf", "file_line_range": [40, 78], "resource": "aws_db_instance.postgres", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-postgres"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-postgres-rds-has-query-logging-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "breadcrumbs": {"final_snapshot_identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "identifier": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "username": [{"type": "variable", "name": "db_username", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "password": [{"type": "variable", "name": "db_password", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.main", "path": "/home/runner/work/Sample/Sample/terraform/rds.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"reports": {"__end_line__": 9, "__start_line__": 2, "bucket": ["social-media-api-reports-${data.aws_caller_identity.current.account_id}"], "tags": [{"Environment": "dev", "Name": "social-media-api-reports"}], "__address__": "aws_s3_bucket.reports"}}}, "evaluated_keys": ["block_public_acls", "block_public_policy", "resource_type"]}, "code_block": [[2, "resource \"aws_s3_bucket\" \"reports\" {\n"], [3, "  bucket = \"${var.project_name}-reports-${data.aws_caller_identity.current.account_id}\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project_name}-reports\"\n"], [7, "    Environment = var.environment\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "repo_file_path": "/terraform/s3.tf", "file_line_range": [2, 9], "resource": "aws_s3_bucket.reports", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-reports"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/runner/work/Sample/Sample/terraform/main.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"reports": {"__end_line__": 9, "__start_line__": 2, "bucket": ["social-media-api-reports-${data.aws_caller_identity.current.account_id}"], "tags": [{"Environment": "dev", "Name": "social-media-api-reports"}], "__address__": "aws_s3_bucket.reports"}}}, "evaluated_keys": ["server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[2, "resource \"aws_s3_bucket\" \"reports\" {\n"], [3, "  bucket = \"${var.project_name}-reports-${data.aws_caller_identity.current.account_id}\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project_name}-reports\"\n"], [7, "    Environment = var.environment\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "repo_file_path": "/terraform/s3.tf", "file_line_range": [2, 9], "resource": "aws_s3_bucket.reports", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-reports"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/runner/work/Sample/Sample/terraform/main.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"reports": {"__end_line__": 9, "__start_line__": 2, "bucket": ["social-media-api-reports-${data.aws_caller_identity.current.account_id}"], "tags": [{"Environment": "dev", "Name": "social-media-api-reports"}], "__address__": "aws_s3_bucket.reports"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": [[2, "resource \"aws_s3_bucket\" \"reports\" {\n"], [3, "  bucket = \"${var.project_name}-reports-${data.aws_caller_identity.current.account_id}\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project_name}-reports\"\n"], [7, "    Environment = var.environment\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "repo_file_path": "/terraform/s3.tf", "file_line_range": [2, 9], "resource": "aws_s3_bucket.reports", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-reports"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/runner/work/Sample/Sample/terraform/main.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_12", "bc_check_id": "BC_AWS_NETWORKING_4", "check_name": "Ensure the default security group of every VPC restricts all traffic", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"main": {"__end_line__": 10, "__start_line__": 2, "cidr_block": ["10.0.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "social-media-api-vpc"}], "__address__": "aws_vpc.main"}}}, "evaluated_keys": ["egress/to_port", "ingress/to_port", "egress/from_port", "resource_type", "egress/protocol", "ingress/protocol", "ingress/self", "ingress/from_port", "egress/cidr_blocks"]}, "code_block": [[2, "resource \"aws_vpc\" \"main\" {\n"], [3, "  cidr_block           = \"10.0.0.0/16\"\n"], [4, "  enable_dns_hostnames = true\n"], [5, "  enable_dns_support   = true\n"], [6, "\n"], [7, "  tags = {\n"], [8, "    Name = \"${var.project_name}-vpc\"\n"], [9, "  }\n"], [10, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [2, 10], "resource": "aws_vpc.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_11", "bc_check_id": "BC_AWS_LOGGING_9", "check_name": "Ensure VPC flow logging is enabled in all VPCs", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"main": {"__end_line__": 10, "__start_line__": 2, "cidr_block": ["10.0.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "social-media-api-vpc"}], "__address__": "aws_vpc.main"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[2, "resource \"aws_vpc\" \"main\" {\n"], [3, "  cidr_block           = \"10.0.0.0/16\"\n"], [4, "  enable_dns_hostnames = true\n"], [5, "  enable_dns_support   = true\n"], [6, "\n"], [7, "  tags = {\n"], [8, "    Name = \"${var.project_name}-vpc\"\n"], [9, "  }\n"], [10, "}\n"]], "file_path": "/ecs.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "repo_file_path": "/terraform/ecs.tf", "file_line_range": [2, 10], "resource": "aws_vpc.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "social-media-api-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/ecs.tf", "breadcrumbs": {"tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"reports": {"__end_line__": 9, "__start_line__": 2, "bucket": ["social-media-api-reports-${data.aws_caller_identity.current.account_id}"], "tags": [{"Environment": "dev", "Name": "social-media-api-reports"}], "__address__": "aws_s3_bucket.reports"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[2, "resource \"aws_s3_bucket\" \"reports\" {\n"], [3, "  bucket = \"${var.project_name}-reports-${data.aws_caller_identity.current.account_id}\"\n"], [4, "\n"], [5, "  tags = {\n"], [6, "    Name        = \"${var.project_name}-reports\"\n"], [7, "    Environment = var.environment\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/s3.tf", "file_abs_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "repo_file_path": "/terraform/s3.tf", "file_line_range": [2, 9], "resource": "aws_s3_bucket.reports", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "dev", "Name": "social-media-api-reports"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/Sample/Sample/terraform/s3.tf", "breadcrumbs": {"bucket": [{"type": "data", "name": "aws_caller_identity.current", "path": "/home/runner/work/Sample/Sample/terraform/main.tf", "module_connection": false}], "tags.Name": [{"type": "variable", "name": "project_name", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}], "tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/Sample/Sample/terraform/variables.tf", "module_connection": false}]}}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 58, "failed": 34, "skipped": 0, "parsing_errors": 0, "resource_count": 35, "checkov_version": "3.2.489"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}